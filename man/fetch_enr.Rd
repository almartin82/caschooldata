% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fetch_enrollment.R
\name{fetch_enr}
\alias{fetch_enr}
\title{Fetch California enrollment data}
\usage{
fetch_enr(end_year, tidy = TRUE, use_cache = TRUE)
}
\arguments{
\item{end_year}{A school year. Year is the end of the academic year - e.g., 2024
for the 2023-24 school year. Supports 1982-2025:
\itemize{
\item 2024-2025: Modern Census Day files with full demographic breakdowns
\item 2008-2023: Historical files with race/gender data and entity names
\item 1994-2007: Historical files with race/gender data (no entity names)
\item 1982-1993: Historical files with letter-based race codes
}}

\item{tidy}{If TRUE (default), returns data in long (tidy) format with grade
and subgroup columns. If FALSE, returns wide format with grade columns.}

\item{use_cache}{If TRUE (default), uses locally cached data when available.
Set to FALSE to force re-download from CDE.}
}
\value{
A tibble with enrollment data. In tidy format, includes columns:
\itemize{
\item \code{end_year}: School year end (integer)
\item \code{cds_code}: 14-digit CDS identifier
\item \code{county_code}: 2-digit county code
\item \code{district_code}: 5-digit district code
\item \code{school_code}: 7-digit school code
\item \code{agg_level}: Aggregation level (T=State, C=County, D=District, S=School)
\item \code{county_name}, \code{district_name}, \code{school_name}: Entity names
\item \code{charter_status}: Charter indicator (Y/N/All)
\item \code{grade_level}: Grade (TK, K, 01-12, or TOTAL). Note: TK is NA for 1982-2023.
\item \code{reporting_category}: CDE demographic category code
\item \code{subgroup}: Human-readable subgroup name
\item \code{n_students}: Enrollment count
}
}
\description{
Downloads and processes enrollment data from the California Department of
Education DataQuest data files. Data is based on Census Day enrollment
(first Wednesday in October).
}
\details{
Historical data differs from modern (2024+) data in several ways:
\itemize{
\item Transitional Kindergarten (TK) data is not available (grade_tk is NA)
\item Charter status is not available (charter_status is "All")
\item District and county aggregates are computed from school-level data
\item Student group categories (SG_*) are not available
\item For 1994-2007: Entity names are not available (use CDS code to look up)
\item For 1982-1993: Race categories use different coding (mapped to modern codes)
}
}
\examples{
\dontrun{
# Get 2024 enrollment data (2023-24 school year)
enr_2024 <- fetch_enr(2024)

# Get historical data (2019-20 school year)
enr_2020 <- fetch_enr(2020)

# Get data from the 1990s
enr_1995 <- fetch_enr(1995)

# Get wide format (one column per grade)
enr_wide <- fetch_enr(2024, tidy = FALSE)

# Force fresh download (ignore cache)
enr_fresh <- fetch_enr(2024, use_cache = FALSE)

# Filter to school-level total enrollment
library(dplyr)
schools <- enr_2024 \%>\%
  filter(agg_level == "S", reporting_category == "TA", grade_level == "TOTAL")
}
}
